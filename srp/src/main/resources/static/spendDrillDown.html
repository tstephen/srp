<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>Finance Module</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <link href="css/srp.css" rel="stylesheet">
    
    <style type="text/css">
        .slice text {
            font-size: 16pt;
        }   
    </style>
  </head>
  <body class="container">
  <section>
    <h1>
      <a class="nav navbar-brand" href="http://srp.digital">
        <img src="/images/icon/srp-icon-256x256.png" alt="logo"/>
      </a>
      <span>Finance Module</span>
    </h1>
    <div class="clearfix" id="messages">
    </div>
  </section>
  
  <section id="container"></section>
    
  <script id='template' type='text/ractive'>

      <h2>
        <span class="clickable glyphicon glyphicon-chevron-up" aria-hidden="true" id="navUp" on-click="navigateUp()" style="display:none"></span>
        <span>{{title}}</span>
      </h2>
      <section class="col-md-6" id="table">
        <h3>Summary</h3>
        <table id="transactionSummariesTable" class="table table-striped">
          <thead>
            <tr>
              <th></th>
              <th>Category</th>
              <th class="pull-right">Amount (Â£)</th>
            </tr>
          </thead>
          <tbody>
          {{#each sortBy(transactionSummaries, sortColumn) :i}}
            <tr data-code="{{code}}" data-href="{{_links.self.href}}" on-click="navigateDown(this.code)">
              <td>{{i+1}}</td>
              <td>{{description == '' ? 'Uncategorised' : description.toLabel()}}</td>
              <td style="text-align:right">{{Math.round(amount).toString().formatNumber(',')}}</td>
            </tr>
          {{/each}}
          </tbody>
          <tfoot>
            <tr>
              <th></th>
              <th>Total</th>
              <th class="pull-right">{{sum(transactionSummaries).toString().formatNumber(',')}}</th>
            </tr>
          </tfoot>
        </table>
      </section>

      <section class="col-md-6" id="chartSect">
        <h3>Chart</h3>
        <div id="chart"/>
      </section>
    </script>

  <script src="/webjars/jquery/1.11.1/jquery.min.js"></script>
  <script src="/webjars/bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script src="/webjars/Bootstrap-3-Typeahead/3.1.1/bootstrap3-typeahead.js"></script>
  <script src="/webjars/ractive/0.7.1/ractive.min.js"></script>
  <script src="/webjars/d3js/3.5.5/d3.min.js"></script>
  
  <script src="js/string-functions-0.1.0.js"></script>
  <script src="js/charts-1.1.0.js"></script>
  <script src="js/finance-1.1.0.js"></script>
  
  <script type="text/javascript">
    $(document).ready(function() {
      ractive.fetchAndRenderChart(ractive.get('tenant.id')+"/financialTransactionsSummary/byDefraDeccCategory");
    })
  </script>
  
  </body>
</html>