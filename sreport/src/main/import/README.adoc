1. Create table from sdu_org.sql

2. import CSV file

    export table=sdu_org
    export collist=c_org_code,name,c_nhs_area,c_phe_centre,c_region,account_type,c_sdmp,c_adaptation,c_on_track_34_pct,c_healthy_tp,c_gcc,c_sr_score,c_sr_pct,c_nrg,c_nrg_fte,c_water,c_water_fte,c_waste,c_waste_change
    mysql -u root -p srp_db --execute="LOAD DATA INFILE '/var/lib/mysql-files/sdu_org.csv' INTO TABLE $table FIELDS TERMINATED BY '$' OPTIONALLY ENCLOSED BY '\"' IGNORE 1 LINES ($collist) ; SHOW WARNINGS" > $table.output

3. CREATE account records

    INSERT INTO OL_ACCOUNT 
       (name, account_type, stage, email_confirmed, existing_customer, tenant_id)
    SELECT name, account_type, 'No contact', b'00', b'00', 'sdu'
    FROM sdu_org;
    
4. UPDATE tmp table with account ids

    UPDATE sdu_org o
    SET account_id = ( SELECT min(id) from OL_ACCOUNT a where a.name = o.name )
    
5. Create custom fields
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'orgCode',c_org_code,account_id
    FROM   sdu_org;
   
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'nhsEnglandArea',c_nhs_area,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'pheCentre',c_phe_centre,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'region',c_region,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'sdmp',c_sdmp,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'adaptation',c_adaptation,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'onTrack34Pct',c_on_track_34_pct,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'healthyTP',c_healthy_tp,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'gcc',c_gcc,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'srScore',c_sr_score,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'srPct',c_sr_pct,account_id
    FROM   sdu_org;

    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'energy',c_nrg,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'energyFte',c_nrg_fte,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'water',c_water,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'waterFte',c_water_fte,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'waste',c_waste,account_id
    FROM   sdu_org;
    
    INSERT INTO OL_ACCOUNT_CUSTOM (name,value,account_id)
    SELECT 'wasteChange',c_waste_change,account_id
    FROM   sdu_org;

